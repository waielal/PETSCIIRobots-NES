.segment BANK(BK_SETTINGS)

.proc NMI_SETTINGS
	PPU_DISABLE
		BIT	PPUSTATUS

		PPU_START_OAM_DMA
	
		JSR	SETTINGS_UPDATE_PALETTE

		; reset nametable address
		PPU_LOAD_ADDR  $2000

		BIT	PPUSTATUS
		LDA	#0
		STA	PPUSCROLL
		STA	PPUSCROLL

		; PPU_SCROLL_XY 0, 0, 0
	
	PPU_ENABLE

	; MMC3_IRQ_DISABLE
	; MMC3_IRQ_LATCH 175
	; MMC3_IRQ_RELOAD
	; MMC3_IRQ_ENABLE

	RTS
.endproc
